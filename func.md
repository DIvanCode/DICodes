# Функциональные требования

## Сущности

### Пользователь

- Имеет никнейм, с помощью которого идентифицируется.
- Аутентификация происходит по паролю.
- Имеет открытый рейтинг.

### Дуэль

- Два пользователя, которые называются дуэлянтами.
- Одна (или несколько) задач по спортивному программированию.
- Имеет максимальную длительность.

### Задача

- Условие задачи - легенда, формат входных данных, формат выходных данных.
- Ограничение по времени - ограничение времени работы кода.
- Ограничение по памяти - ограничение памяти, потребляемой запускаемым кодом.
- Тесты - входные данные и вариант выходных данных.
    - Некоторые задачи могут иметь неограниченное количество правильных выходных данных.
    - Некоторые тесты являются открытыми для пользователя, некоторые - закрытыми.
- Чекер - программа, проверяющая правильность выходных данных.
- Правильное решение - программа, выдающая правильные выходные данные на всех тестах.
- Набор теоретических тем, используемых для решения задачи.
    - В задаче может быть указано несколько наборов тем, если есть несколько разных решений.
    - Задача, в которой не используются определённые теоретические темы, имеет пустой набор тем.
- Сложность задачи - число от 1 до 10.
    - Выставляется исходя из уровня пользователя, способного решить задачу.
    - Примерное соответствие уровня задачи этапам ВСОШ:
        - 1 - ниже уровня региона;
        - 2 - A регион;
        - 3 - A-B регион;
        - 4 - B регион;
        - 5 - A всерос / B-C регион;
        - 6 - C регион;
        - 7 - B всерос / C-D регион;
        - 8 - D регион;
        - 9 - C всерос;
        - 10 - D всерос.

### Группа

- Объединение пользователей.
- Роли: создатель, менеджер, участник.

## Сценарии

### Участие в обычной дуэли

- Дуэлянтам выдаётся одна задача.
- Каждый видит окно, разделённое на две части: редактор кода и условие задачи.
- Копирование условия задачи запрещено.
- Можно выбрать язык программирования: C++, Python.
- Дуэлянт пишет решение в редакторе кода.
- Дуэлянт может переключить редактор кода на редактор кода другого - редактирование и копирование кода будет запрещено.
- Имеется возможность запустить кода на одном из открытых тестов из задачи и увидеть вывод.
- Можно добавить свои выходные данные и запускать код на них.
- Отправка решения на проверку называется посылкой.
- По завершении автоматической проверки предоставляется вердикт либо сообщение (например, ошибка компиляции).
- Можно посмотреть свои предыдущие посылки и вердикты, а также скопировать код в редактор кода.
- Дуэлянт, отправивший раньше другого правильное решение, побеждает в дуэли.
- Если время длительности дуэли превысило максимальную длительность, объявляется ничья.
- По завершении дуэли показывается результат, а также изменяется рейтинг дуэлянтов.

### Проверка задачи

- Осуществляется путём запуска решения пользователя на всех тестах.
- Если язык решения подразумевает компиляцию, решение сначала компилируется.
- Стандартное ограничение на время компиляции решения - 30 секунд.
- Если компиляция завершилась с ошибкой - Ошибка компиляции.
- Если компиляция не завершилась - Превышено ограничение по времени компиляции.
- Если на тесте случилось превышение ограничения по времени - Превышено ограничение по времени.
- Если на тесте случилось превышение ограничения по времени - Превышено ограничение по времени.
- Если на тесте случилось падение решения - Ошибка во время исполнения.
- Если решение успешно отработало на тесте, выходные данные проверяются с помощью чекера.
- Если выходные данные неправильные - Неправильный ответ.
- Если выходные данные правильные - Зачтено.
- Если не все тесты имеют вердикт Зачтено, решение не зачнено.
- Вердикт первого теста, на котором вердикт не Зачтено, отображается пользователю.
- Если все тесты имеют вердикт Зачтено, решение Зачтено.

### Конфигурация дуэли

- Обычная дуэль имеет следующие параметры:
    - Рейтинговая.
    - Код другого дуэлянта смотреть можно.
    - Максимальная длительность - 30 минут.
    - Одна задача.
    - Задача имеет сложность, зависящую от рейтинга дуэлянтов.
    - Темы задачи любые.
- Каждый из этих параметров можно конфигурировать.

#### Режим дуэли

- Рейтинговая.
    - Дуэлянты подбираются, исходя из рейтинга.
    - Задачи подбираются, исходя из рейтинга участников.
    - Темы задач любые.
    - После окончания дуэли рейтинг изменяется в соответствии с результатом.
- Тренировочная.
    - Дуэлянты подбираются, исходя из рейтинга.
    - После окончания дуэли рейтинг не изменяется.
- Дружеская.
    - Дуэлянты могут быть подобраны, независимо от рейтинга.
    - После окончания дуэли рейтинг не изменяется.

#### Просмотр кода

- Код другого дуэлянта смотреть можно.
    - Редактор кода можно переключить на просмотр редактора кода другого дуэлянта.
    - Код будет отображаться в режиме реального времени.
    - Копирование и редактирование кода будет запрещено.
    - Редактор кода можно переключить обратно на свой.
- Код другого дуэлянта смотреть нельзя.
    - Редактор кода нельзя переключить на просмотр редактора кода другого дуэлянта.

#### Максимальная длительность

- Минимальная длительность - 5 минут.
- Максимальная длительность - 300 минут.

#### Количество задач

- Минимальное количество - 1 задача.
- Максимальное количество - 5 задач.
- Каждой задаче соотносится количество очков, получаемое при её решении.
- Количество очков зависит от сложности задачи.
- Дуэлянт, первый правильно решивший задачу, получает очки за неё.
- Дуэль завершается либо по времени, либо после решения всех задач.
- Дуэлянт, набравший наибольшее количество очков, побеждает.
- При равенстве очков объявляется ничья.
- При переключении между задачами в интерфейсе, код из редактора кода остаётся в соответствующей задаче.

#### Этапность задач

- Если в дуэли более одной задачи, можно выбрать этапность решения задач.
    - Задачи решаются параллельно.
        - С начала дуэли доступны для решения все задачи.
    - Задачи решаются последовательно.
        - С начала дуэли доступна для решения только первая задача.
        - Последующая задача открывается после того, как предыдущая была сдана одним из дуэлянтов.

#### Сложность задач

- Для каждой задачи в дуэли можно выбрать её сложность - от 1 до 10.
- В таком случае дуэль не может быть рейтинговой.

#### Темы задач

- Задача имеет набор теоретических тем, с помощью которых она решается.
- Либо несколько наборов, если существует несколько решений.
- Можно влиять на набор тем, используемых при решении задач.
    - Запрещать темы. В таком случае каждая задача должна иметь хотя бы одно решение, не использующее указанные темы.
    - Ограничивать темы. В таком случае каждая задача должна иметь хотя бы одно решение, использующее только уканные темы.
    - Выбирать темы. В таком случае каждая задача должна иметь хотя бы одно решение, использующее хотя бы одну из указанных тем.
- В таком случае дуэль не может быть рейтинговой.

### Поиск дуэли

- Обычная дуэль - поиск обычной дуэли.
- Создать дуэль - выбрать конфигурацию дуэли и запустить поиск.
    - Если конфигурация соответствует рейтинговой дуэли, она будет рейтинговая.
    - Иначе дуэль будет тренировочная.
- Выбрать дуэль - выбрать дуэль из доступных в данный момент, созданных другими пользователями.
    - Будут видны дуэли от пользователей, имеющий похожий рейтинг.
    - Если конфигурация соответствует рейтинговой дуэли, она будет рейтинговая.
    - Иначе дуэль будет тренировочная.
- Вызов на дуэль - создать дуэль, выбрать пользователя и отправить ему вызов на дуэль.
    - Если конфигурация соответствует рейтинговой дуэли, а также рейтинги пользователей похожи, дуэль будет рейтинговая.
    - Иначе дуэль будет дружеская.

### История дуэлей

- Имеется возможность посмотреть свои предыдущие дуэли.
- Отображается список с никнеймами дуэлянтов, изменениями рейтинга и датой дуэли.
- Можно выбрать дуэль и зайти в её интерфейс.
- При этом отображается интерфейс участия в дуэли.
- Разрешено дорешивание задач.
- Дорешивание не влияет не результат прошедней дуэли.

### Менеджмент группой

- Пользователь имеет возможность создать группу.
- Он получает роль создателя.
- Можно пригласить в группу других пользователей, если имеешь роль создатель или менеджер.
- Приглашение в группу можно принять или отклонить.
- Управление ролями.
    - Роль создателя выдаётся только создателю группы при создании.
    - Роль менеджера, если имеешь роль создатель.
    - Роль участника, если имеешь роль создатель или менеджер.
- Исключение пользователей из группы:
    - Создателя исключить нельзя.
    - Менеджера может исключить создатель.
    - Участника может исключить создатель или менеджер.
- Выйти из группы может любой, кроме создателя.

### Дуэль в группе

- Менеджер имеет возможность создать дружескую дуэль со своей конфигурацией и выбрать двух дуэлянтов среди пользователей группы.

### Турнир в группе

- Менеджер имеет возможность создать турнир в группе.
- Создатель турнира может выбрать участников турнира среди пользователей группы.
- Подбор дуэлянтов осуществляется случайным образом среди участников, имеющих одинаковое количество победных раундов в турнире.
- Конфигурация всех дуэлей в турнире одинаковая, выбирается при создании.
- Количество раундов в турнире - от 1 до 10.
